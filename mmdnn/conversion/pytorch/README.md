# PyTorch README

## Usage

### Extract PyTorch model

We provide an example code *mmdnn/conversion/examples/pytorch/extract_model.py* to extract PyTorch pre-trained model. You can refer it to extract your own model.

```bash
$ python -m mmdnn.conversion.examples.pytorch.extract_model

usage: extract_model.py [-h] -n
                        {resnet152,vgg16,inception_v3,densenet,squeezenet,vgg19}
                        [-i IMAGE]
```

### Convert models from IR to PyTorch code snippet

Since the generated PyTorch model code snippet can restore weights from IR weights file directly, we don't need to convert weights in this step.

```bash
$ python -m mmdnn.conversion._script.IRToCode -f keras --IRModelPath inception_v3.pb --dstModelPath keras_inception_v3.py

Parse file [inception_v3.pb] with binary format successfully.
Target network code snippet is saved as [keras_inception_v3.py].
```

### Convert models from IR to Keras model

After generating the keras code snippet, you can convert the Keras code snippet and IR weights file to Keras original model for further usage.

```bash
$ python -m mmdnn.conversion.examples.keras.imagenet_test -n keras_inception_v3.py -w inception_v3.npy --dump keras_inception_v3.h5

Using TensorFlow backend.
.
.
.
Keras model file is saved as [keras_inception_v3.h5], generated by [keras_inception_v3.py] and [inception_v3.npy].
```

## Support Operators

- Add
- Concat
- Relu
- Softmax
- Tanh
- Sigmoid
- Softplus
- Softsign
- HardSigmoid
- Elu

## Develop version

Ubuntu 16.04 with

- Keras 2.1.1

- Tensorflow GPU 1.4.0

@ 11/21/2017

## Limitation

- Lambda layer no support

  - *inception_resnet_v2* pre-trained model no support

- Currently no RNN related operations support

- Model in model is not supported yet. We can implement it if needed.
